<!DOCTYPE html>  <html> <head>   <title>tc.validation.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="tc.field.autocomplete.html">                 tc.field.autocomplete.js               </a>                                           <a class="source" href="tc.field.dropdown.html">                 tc.field.dropdown.js               </a>                                           <a class="source" href="tc.field.hint.html">                 tc.field.hint.js               </a>                                           <a class="source" href="tc.field.html">                 tc.field.js               </a>                                           <a class="source" href="tc.field.std.html">                 tc.field.std.js               </a>                                           <a class="source" href="tc.field.validator.html">                 tc.field.validator.js               </a>                                           <a class="source" href="tc.seed.html">                 tc.seed.js               </a>                                           <a class="source" href="tc.validation.html">                 tc.validation.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tc.validation.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*    _____                    _____          </span>
<span class="cm">     /\    \                  /\    \         </span>
<span class="cm">    /::\    \                /::\    \        </span>
<span class="cm">    \:::\    \              /::::\    \       </span>
<span class="cm">     \:::\    \            /::::::\    \      </span>
<span class="cm">      \:::\    \          /:::/\:::\    \     </span>
<span class="cm">       \:::\    \        /:::/  \:::\    \    </span>
<span class="cm">       /::::\    \      /:::/    \:::\    \   </span>
<span class="cm">      /::::::\    \    /:::/    / \:::\    \  </span>
<span class="cm">     /:::/\:::\    \  /:::/    /   \:::\    \ </span>
<span class="cm">    /:::/  \:::\____\/:::/____/     \:::\____\</span>
<span class="cm">   /:::/    \::/    /\:::\    \      \::/    /</span>
<span class="cm">  /:::/    / \/____/  \:::\    \      \/____/ </span>
<span class="cm"> /:::/    /            \:::\    \             </span>
<span class="cm">/:::/    /              \:::\    \            </span>
<span class="cm">\::/    /                \:::\    \           </span>
<span class="cm"> \/____/                  \:::\    \          </span>
<span class="cm">                           \:::\    \         </span>
<span class="cm">                            \:::\____\        </span>
<span class="cm">                             \::/    /        </span>
<span class="cm">                              \/____/         </span>
<span class="cm">                             TYPE/CODE        </span>
<span class="cm">                         From 2010 till âˆž     </span>
<span class="cm">                         typecode-js v0.1       </span>
<span class="cm">                                                */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nx">$</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">NI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">NI</span><span class="p">,</span>
	    <span class="nx">console</span> <span class="o">=</span> <span class="nx">NI</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">getConsole</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
regular expressions</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="p">{</span>
		<span class="nx">email</span><span class="o">:</span> <span class="sr">/^((&quot;[\w-\s]+&quot;)|([\w-]+(?:\.[\w-]+)*)|(&quot;[\w-\s]+&quot;)([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i</span><span class="p">,</span>
		
		<span class="nx">url</span><span class="o">:</span> <span class="sr">/^((ht|f)tps?:\/\/)?[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s&lt;&gt;\%&quot;\,\{\}\\|\\\^\[\]`]+)?$/</span><span class="p">,</span>
		
		<span class="nx">alphanumeric</span><span class="o">:</span>  <span class="sr">/^\s*[a-z\d\.]+([a-z\d\.]*\.|\s*\-\s*[a-z\d\.]+)?(\s+[a-z\d\.]+(\.|\s*\-\s*[a-z\d\.]+)?)*\s*$/i</span><span class="p">,</span>
		
		<span class="nx">number</span><span class="o">:</span> <span class="sr">/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/</span>
	<span class="p">};</span>
	
	<span class="kd">function</span> <span class="nx">regTest</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">regex</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
	<span class="p">}</span>
	</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
tests</p>             </td>             <td class="code">               <div class="highlight"><pre>	
	<span class="kd">var</span> <span class="nx">is</span> <span class="o">=</span> <span class="p">{</span>
		
		<span class="nx">empty</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
		<span class="p">},</span>
		
		<span class="nx">alphaNumeric</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">regTest</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="s2">&quot;alphanumeric&quot;</span><span class="p">);</span>
		<span class="p">},</span>

		<span class="nx">email</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">regTest</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">);</span>
		<span class="p">},</span>
	
		<span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">regTest</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">);</span>
		<span class="p">},</span>
	
		<span class="nx">num</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">regTest</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">);</span>
		<span class="p">},</span>
	
		<span class="nx">numNonNegative</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">isNum</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">},</span>
	
		<span class="nx">numPositive</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">isNum</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">},</span>
	
		<span class="nx">date</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">buf</span><span class="p">,</span> <span class="nx">date</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">buf</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">buf</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">month</span> <span class="o">=</span> <span class="nx">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^0+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
					<span class="nx">day</span> <span class="o">=</span> <span class="nx">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^0+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
					<span class="nx">year</span> <span class="o">=</span> <span class="nx">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^0+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">year</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="nx">year</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">4</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="k">try</span> <span class="p">{</span>
						<span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
						<span class="nx">month</span> <span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
						<span class="nx">date</span><span class="p">.</span><span class="nx">setFullYear</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">==</span> <span class="nx">month</span> <span class="o">&amp;&amp;</span> 
						    <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">==</span> <span class="nx">day</span> <span class="o">&amp;&amp;</span> 
						    <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">==</span> <span class="nx">year</span><span class="p">)</span> <span class="p">{</span>
								<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
							<span class="p">}</span>
					<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>ignore</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span>
	</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
built-in validators</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">var</span> <span class="nx">error_messages</span> <span class="o">=</span> <span class="p">{</span>
		
		<span class="nx">required</span><span class="o">:</span> <span class="s2">&quot;This is a required field&quot;</span><span class="p">,</span>
		
		<span class="nx">alphanumeric</span><span class="o">:</span> <span class="s2">&quot;This is not a valid alpha-numeeric value&quot;</span><span class="p">,</span>
		
		<span class="nx">email</span><span class="o">:</span> <span class="s2">&quot;This is not a valid Email address&quot;</span><span class="p">,</span>
		
		<span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;This is not a valid URL&quot;</span><span class="p">,</span>
		
		<span class="nx">number</span><span class="o">:</span> <span class="s2">&quot;This is not a valid number&quot;</span><span class="p">,</span>
		
		<span class="nx">date</span><span class="o">:</span> <span class="s2">&quot;This is not a valid date&quot;</span>
	<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
field validation    </p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>begin ValidationToken</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">function</span> <span class="nx">ValidationToken</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">clean</span><span class="p">();</span>
	<span class="p">}</span>
	
	<span class="nx">ValidationToken</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
		<span class="nx">errors</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">errs</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">errs</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">addError</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">errs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">clean</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">errs</span> <span class="o">=</span> <span class="p">[];</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>end ValidationToken</p>             </td>             <td class="code">               <div class="highlight"><pre>	
	</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>begin validate</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">function</span> <span class="nx">validate</span><span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> 
		    <span class="nx">validators</span><span class="p">,</span> 
		    <span class="nx">token</span><span class="p">,</span> 
		    <span class="nx">errors</span><span class="p">,</span>
		    <span class="nx">type</span><span class="p">,</span>
		    <span class="nx">master</span><span class="p">;</span>
		
		<span class="nx">master</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">);</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="nx">master</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">master</span><span class="p">.</span><span class="nx">get_val</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>the field is an instance of NI.Field</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">value</span> <span class="o">=</span> <span class="nx">master</span><span class="p">.</span><span class="nx">get_val</span><span class="p">();</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">switch</span> <span class="p">(</span><span class="nx">field</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="p">{</span>
				<span class="k">case</span> <span class="s2">&quot;input&quot;</span><span class="o">:</span>
					<span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span><span class="p">;</span>
					<span class="k">switch</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">case</span> <span class="s2">&quot;radio&quot;</span><span class="o">:</span>
						<span class="k">case</span> <span class="s2">&quot;checkbox&quot;</span><span class="o">:</span>
							<span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;bool&quot;</span><span class="p">;</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s2">&quot;checked&quot;</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">;</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">default</span><span class="o">:</span>
							<span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
							<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="s2">&quot;textarea&quot;</span><span class="o">:</span>
					<span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="s2">&quot;select&quot;</span><span class="o">:</span>
					<span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;select&quot;</span><span class="p">;</span>
					<span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;option:selected&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">default</span><span class="o">:</span>
					<span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">checkStr</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
		
		<span class="nx">validators</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;validators&quot;</span><span class="p">);</span>
		<span class="nx">token</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">);</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">validators</span> <span class="o">||</span> <span class="o">!</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Field not prepared for validation&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="nx">token</span><span class="p">.</span><span class="nx">clean</span><span class="p">();</span>

		<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">validators</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">validation</span><span class="p">;</span>
			<span class="nx">t</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">v</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">t</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">v</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">validators</span><span class="p">[</span><span class="nx">v</span><span class="p">]))</span> <span class="p">{</span>
					<span class="nx">validation</span> <span class="o">=</span> <span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">validators</span><span class="p">[</span><span class="nx">v</span><span class="p">](</span><span class="nx">value</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">validation</span> <span class="o">&amp;&amp;</span> <span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span> <span class="o">&amp;&amp;</span> <span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
						<span class="p">});</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;maxlen&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="s2">&quot;This cannot exceed &quot;</span><span class="o">+</span> <span class="nx">max</span> <span class="o">+</span><span class="s2">&quot; characters&quot;</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}(</span><span class="nx">v</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]));</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;minlen&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">min</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">min</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="s2">&quot;This must be at least &quot;</span><span class="o">+</span> <span class="nx">min</span> <span class="o">+</span><span class="s2">&quot; characters&quot;</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}(</span><span class="nx">v</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]));</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">switch</span> <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">case</span> <span class="s2">&quot;required&quot;</span><span class="o">:</span>
							<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
								<span class="kd">var</span> <span class="nx">err</span><span class="p">;</span>
								<span class="nx">err</span> <span class="o">=</span> <span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">];</span>
								<span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;bool&quot;</span><span class="p">)</span> <span class="p">{</span>
									<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span> <span class="p">{</span>
										<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
									<span class="p">}</span>
								<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;select&quot;</span><span class="p">)</span> <span class="p">{</span>
									<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;-1&quot;</span><span class="p">)</span> <span class="p">{</span>
										<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
									<span class="p">}</span>
								<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
									<span class="k">if</span> <span class="p">(</span><span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
										<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
									<span class="p">}</span>
								<span class="p">}</span>
							<span class="p">}());</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="s2">&quot;alphanumeric&quot;</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is</span><span class="p">.</span><span class="nx">alphaNumeric</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;alphanumeric&quot;</span><span class="p">]);</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="s2">&quot;email&quot;</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is</span><span class="p">.</span><span class="nx">email</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]);</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="s2">&quot;url&quot;</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is</span><span class="p">.</span><span class="nx">url</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]);</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="s2">&quot;number&quot;</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is</span><span class="p">.</span><span class="nx">num</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">]);</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="s2">&quot;date&quot;</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is</span><span class="p">.</span><span class="nx">date</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]);</span>
							<span class="p">}</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">default</span><span class="o">:</span>
							<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">t</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">validation</span> <span class="o">=</span> <span class="nx">v</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span> <span class="o">&amp;&amp;</span> <span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">token</span><span class="p">.</span><span class="nx">addError</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">});</span>
		
		<span class="nx">errors</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">errors</span><span class="p">();</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">errors</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">field</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;validationFail&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">errors</span><span class="o">:</span> <span class="nx">errors</span> <span class="p">});</span>
			<span class="k">return</span> <span class="p">{</span> <span class="nx">valid</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">errors</span><span class="o">:</span> <span class="nx">errors</span> <span class="p">};</span>
		<span class="p">}</span>
		<span class="nx">field</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;validationPass&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="p">{</span> <span class="nx">valid</span><span class="o">:</span> <span class="kc">true</span> <span class="p">};</span>
	<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>end validate</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>begin reset</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">function</span> <span class="nx">reset</span><span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">token</span><span class="p">;</span>
		
		<span class="nx">token</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">);</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Field not prepared for validation&quot;</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="nx">token</span><span class="p">.</span><span class="nx">clean</span><span class="p">();</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">field</span><span class="p">);</span>
		<span class="nx">field</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;validationReset&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="p">{</span> <span class="p">};</span>
	<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>end reset</p>             </td>             <td class="code">               <div class="highlight"><pre>	
	</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
manager</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
		<span class="nx">fieldValidationPass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-invalid&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;state-valid&quot;</span><span class="p">);</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;fieldValidationPass&quot;</span><span class="p">,</span> <span class="nx">d</span><span class="p">);</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">isValid</span><span class="p">();</span>
			<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">fieldValidationFail</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-valid&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;state-invalid&quot;</span><span class="p">);</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;fieldValidationFail&quot;</span><span class="p">,</span> <span class="nx">d</span><span class="p">);</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">isValid</span><span class="p">();</span>
			<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">fieldValidationReset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-valid state-invalid&quot;</span><span class="p">);</span>
			<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">watchEventHandler</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">){</span>
			<span class="nx">validate</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
		<span class="p">},</span>
		<span class="nx">managerValidationPass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">){</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-invalid&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;state-valid&quot;</span><span class="p">);</span>
		<span class="p">},</span>
		<span class="nx">managerValidationFail</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">){</span>
			<span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manager</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-valid&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;state-invalid&quot;</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">};</span>

	<span class="kd">function</span> <span class="nx">ValidationManager</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
				
		<span class="k">this</span><span class="p">.</span><span class="nx">o</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
			<span class="nx">$mother</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
			<span class="nx">spec</span><span class="o">:</span> <span class="p">[],</span>
			<span class="nx">watchEvents</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;keyup&#39;</span><span class="p">,</span> <span class="s1">&#39;change&#39;</span><span class="p">]</span>
		<span class="p">},</span> <span class="nx">options</span><span class="p">);</span>
		
		<span class="k">this</span><span class="p">.</span><span class="nx">internal</span> <span class="o">=</span> <span class="p">{</span>
			<span class="nx">eventTarget</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nx">$mother</span> <span class="o">||</span> <span class="nx">$</span><span class="p">({})</span>
		<span class="p">};</span>
		
		<span class="k">this</span><span class="p">.</span><span class="nx">fields</span> <span class="o">=</span> <span class="p">[];</span>
		
		<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nx">spec</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">me</span><span class="p">.</span><span class="nx">addField</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
		<span class="p">});</span>
		
		<span class="k">this</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;managerValidationFail&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">managerValidationFail</span><span class="p">)</span>
			<span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;managerValidationPass&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">managerValidationPass</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
		<span class="nx">addField</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">field</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
			<span class="nx">field</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">item</span><span class="p">.</span><span class="nx">element</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">element</span><span class="p">)</span> <span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">element</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">field</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">validators</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
			<span class="p">}</span>
			
			<span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;validators&quot;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">validators</span><span class="p">);</span>
			<span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">ValidationToken</span><span class="p">());</span>
			
			<span class="nx">field</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;validationPass&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">fieldValidationPass</span><span class="p">)</span>
				 <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;validationFail&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">fieldValidationFail</span><span class="p">)</span>
				 <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;validationReset&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">fieldValidationReset</span><span class="p">)</span>
				 <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span><span class="p">,</span> <span class="nx">field</span><span class="o">:</span><span class="nx">field</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span>
					<span class="nx">validate</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">field</span><span class="p">);</span>
				<span class="p">});</span>
			
			<span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nx">watchEvents</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">field</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nx">watchEvents</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="p">{</span> <span class="nx">manager</span><span class="o">:</span><span class="k">this</span> <span class="p">},</span> <span class="nx">events</span><span class="p">.</span><span class="nx">watchEventHandler</span><span class="p">);</span>
			<span class="p">}</span>
			
			<span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">field</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>validate(field);</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="p">},</span>
		<span class="nx">validate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">errorCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			 
			<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">validation</span> <span class="o">=</span> <span class="nx">validate</span><span class="p">(</span><span class="nx">field</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">validation</span><span class="p">.</span><span class="nx">valid</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">errorCount</span> <span class="o">+=</span> <span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">});</span>
			
			<span class="k">return</span> <span class="nx">errorCount</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">isValid</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">errors</span><span class="p">;</span>
			<span class="nx">errors</span> <span class="o">=</span> <span class="p">[];</span>
			<span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">).</span><span class="nx">errors</span><span class="p">())</span> <span class="p">{</span>
					<span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
						<span class="nx">field</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
						<span class="nx">token</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">)</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;managerValidationFail&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">errors</span><span class="o">:</span><span class="nx">errors</span><span class="p">});</span>
				<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">eventTarget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;managerValidationPass&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">errors</span><span class="o">:</span><span class="nx">errors</span><span class="p">});</span>
			<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
		<span class="p">},</span>
		<span class="nx">reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fields</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">field</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;vtoken&quot;</span><span class="p">).</span><span class="nx">clean</span><span class="p">();</span>
				<span class="nx">field</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;validationReset&quot;</span><span class="p">);</span>
			<span class="p">});</span>
			<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nx">$mother</span> <span class="k">instanceof</span> <span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;state-valid state-invalid&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">invalidFieldCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span>
	
	<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">validators</span> <span class="o">=</span> <span class="p">{};</span>
	
	<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">registerValidator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">checkStr</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
		<span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">checkFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
		<span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Warning: you are overriding the built-in validator: &quot;</span><span class="o">+</span> <span class="nx">key</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>console.warn("Cannot override the built-in validator: "+ key);
return;</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="p">}</span>
		<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">validators</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
	<span class="p">};</span>
	
	<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">registerErrorMessage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">note</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">checkStr</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
		<span class="nx">NI</span><span class="p">.</span><span class="nx">ex</span><span class="p">.</span><span class="nx">checkStr</span><span class="p">(</span><span class="nx">note</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">error_messages</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
			<span class="nx">error_messages</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">note</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			
		<span class="p">}</span>
	<span class="p">};</span>
	
	<span class="nx">ValidationManager</span><span class="p">.</span><span class="nx">makeRangeValidator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">low</span><span class="p">,</span> <span class="nx">high</span><span class="p">,</span> <span class="nx">note</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">note</span> <span class="o">=</span> <span class="nx">note</span> <span class="o">||</span> <span class="s2">&quot;This must be between &quot;</span><span class="o">+</span> <span class="nx">low</span> <span class="o">+</span><span class="s2">&quot; and &quot;</span><span class="o">+</span> <span class="nx">high</span><span class="p">;</span>
		<span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">value</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&lt;</span> <span class="nx">low</span> <span class="o">||</span> <span class="nx">value</span> <span class="o">&gt;</span> <span class="nx">high</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="p">{</span> <span class="nx">valid</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">errors</span><span class="o">:</span> <span class="p">[</span><span class="nx">note</span><span class="p">]</span> <span class="p">};</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="p">{</span> <span class="nx">valid</span><span class="o">:</span> <span class="kc">true</span> <span class="p">};</span>
		<span class="p">};</span>
	<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</p>             </td>             <td class="code">               <div class="highlight"><pre>	
	<span class="nx">NI</span><span class="p">.</span><span class="nx">ValidationManager</span> <span class="o">=</span> <span class="nx">ValidationManager</span><span class="p">;</span>
	<span class="nx">NI</span><span class="p">.</span><span class="nx">is</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">NI</span><span class="p">.</span><span class="nx">is</span> <span class="o">||</span> <span class="p">{},</span> <span class="nx">is</span><span class="p">);</span>
	
<span class="p">}(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">jQuery</span><span class="p">));</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 